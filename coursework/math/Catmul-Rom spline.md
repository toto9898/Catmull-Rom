# Catmull-Rom сплайн: Конструкция и анимация в приложението

## Какво е Catmull-Rom сплайн?
Catmull-Rom сплайнът е интерполираща крива, която минава през всички свои контролни точки. В нашето приложение той се реализира чрез преобразуване на всеки сегмент между четири последователни точки в еквивалентна крива на Безие от трета степен (кубична), която се визуализира и анимира стъпка по стъпка.

## Математическа конструкция

**Извеждане на формулите:**

Catmull-Rom сплайнът интерполира точките $P_1$ и $P_2$ така, че кривата да е $C^1$-гладка. За да се получи еквивалентна кубична Безие крива, трябва да намерим четири контролни точки $B_0, B_1, B_2, B_3$, така че:
- $B_0 = P_1$ (кривата започва от $P_1$)
- $B_3 = P_2$ (кривата завършва в $P_2$)

Векторите на тангентите в $P_1$ и $P_2$ се определят от съседните точки:
- Тангента в $P_1$: $\vec{T}_1 = \frac{1}{2}(P_2 - P_0)$
- Тангента в $P_2$: $\vec{T}_2 = \frac{1}{2}(P_3 - P_1)$

За кубична Безие крива тангентите в началото и края са:
- $B_1 = B_0 + \frac{1}{3}\vec{T}_1$
- $B_2 = B_3 - \frac{1}{3}\vec{T}_2$

Заместваме $B_0 = P_1$, $B_3 = P_2$ и изразите за тангентите:
- $B_1 = P_1 + \frac{1}{3} \cdot \frac{1}{2}(P_2 - P_0) = P_1 + \frac{1}{6}(P_2 - P_0)$
- $B_2 = P_2 - \frac{1}{3} \cdot \frac{1}{2}(P_3 - P_1) = P_2 - \frac{1}{6}(P_3 - P_1)$

Така получаваме формулите, използвани в приложението:

- $B_0 = P_1$
- $B_1 = P_1 + \frac{1}{6}(P_2 - P_0)$
- $B_2 = P_2 - \frac{1}{6}(P_3 - P_1)$
- $B_3 = P_2$

Тези точки се подават на de Casteljau алгоритъма, за да се изчислят точките по кривата.

## Реализация
Catmull-Rom сплайнът в приложението се реализира чрез:
- Преобразуване на всеки сегмент в кубична Безие крива (виж формулите по-горе)
- Анимирано построяване на вътрешните контролни точки с визуални вектори и трансформации
- Интерактивно добавяне, местене и анимиране на точки чрез съвременен UI
- Използване на de Casteljau алгоритъма за гладко изчертаване на кривата
